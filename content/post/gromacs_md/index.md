---
title: Molecular Dynamics Simulation with Gromacs
subtitle: 

# Summary for listings and search engines
summary: MD Simulation using Gromacs Experiment Document in CADD course

# Link this post with a project
projects: []

# Date published
date: 2021-05-04T00:00:00Z

# Date updated
lastmod: 2021-05-06T00:00:00Z

# Is this an unpublished draft?
draft: false

# Show this page in the Featured widget?
featured: false

# Featured image
# Place an image named `featured.jpg/png` in this page's folder and customize its options here.
image:
  caption: ""
  focal_point: ""
  placement: 2
  preview_only: false

authors:
- admin

categories:
- Molecular Dynamics
- CADD
---

### Overall Workflow

The general workflow of MD simulation using Gromacs is shown below.  

{{< figure src="workflow.png" title="Workflow for MD simulation using Gromacs" >}}

  
### Material and Methods

#### Step 0 Structure Preparation

Before producing MD simulation, a given protein structure is a must. Theoretically, most protein can undergo such a simulation while I suggest a smaller size one for the aim of getting acquaintance with the MD workflow. In the example MD experiment, I utilized one pdb file in previous study generated by [I-TASSER](https://zhanglab.ccmb.med.umich.edu/I-TASSER).

#### Step 1 Structure Conversion and Topology

Since the structure obtained from the PDB only contains coordinates, topology is the first to be constructed, which describes the system in terms of atom types, charges, bonds, etc. This topology is specific to a certain force field and the force field to be used is one of the issues requiring careful consideration. Here, Amber99SB force field and TIP3P water model were used for protein.pdb.


#### Step 2 Periodical Boundary Conditions

Before being able to proceed, a general layout of the simulation setup has to be chosen, which are commonly performed under periodic boundary conditions (PBC), meaning that a single unit cell is defined. In this way, an infinite, periodic system can be simulated, avoiding edge effects due to the walls of the simulation volume. Here, cubic box type was set using editconf. To disallow direct interactions between periodic images we set a minimal distance of 0.8 nm between the protein and the wall of the cell, such that no two neighbours will be closer than 1.6 nm.


#### Step 3 Solvate Addition

Since the unit cell is set up, solvent can be added. There are several solvent models, each of which is more or less intimately linked to a force field. Here, spc216.gro was utilized. The topology is not required for solvent generation, but may be updated to include the solvent added.


#### Step 4 Addition of Ions: Counter Charge and Concentration

The program genion can take care of tasks involving adding a number of counterions for the net charge and considering good practice to add ions up to a certain concentration since the net charge of the system still remains.   
NOTE: a specific .mdp configuration file is a must.


#### Step 5 Energy Minimization of the Solvated System

Now the whole simulation system is defined. However, the generation of solvent as well as the placement of ions, may have caused unfavourable interactions, e.g. overlapping atoms, equal charges too close together. Therefore, the system requires energy minimization via running grompp and mdrun.  
NOTE: a specific .mdp configuration file is a must.


#### Step 6 Temperature Coupling mdrun(NVT)

After energy minimization, it's time to turn up the heat, and start to couple the system to the heat bath, which means a short run will be performed in which the temperature coupling is turned on and the system is allowed to relax to the new conditions.  
NOTE: a specific .mdp configuration file is a must.


#### Step 7 Producing Simulation(MD Sampling)

Now, think about the purpose of the simulation. The control parameters in .mdp configuration file have to be chosen such that the simulation will allow analysing the properties one has in mind. Finally, equilibrated solvated system containing target protein of interest has been generated and it is time to start a production simulation.   
NOTE: a specific .mdp configuration file is a must.


#### Step 8 MD Results Analysis

The analysis programs will work after the simulation is already done, personalized purpose can figure out various phenomena depending on the MD simulation result, e.g. RMSD and RMSF for C-alpha, hydrogen bonds between residues from different domains, etc.


For more parameter explanations, please click for [Gromacs](http://www.gromacs.org/).

Gromacs related commands and configuration files have been uploaded to GitHub, for more details please refer to [Yu Zhu's personal GitHub Page](https://github.com/JudeYu99/CADD).
  

### Reference
1.	_1.  Van Der Spoel, D., Lindahl, E., Hess, B., Groenhof, G., Mark, A. E., & Berendsen, H. J. (2005). GROMACS: fast, flexible, and free. Journal of computational chemistry, 26(16), 1701â€“1718._
2.	_.  Lindahl, Abraham, Hess, & van der Spoel. (2021, March 8). GROMACS 2021.1 Manual (Version 2021.1). Zenodo._


